title: UIKit æ‰©å±•ç³»åˆ—ä¹‹ UIView
date: 2017-08-13 2:48:13
tags: [iOS,Swift]
---

## å‰è¨€
â€ƒâ€ƒå¯¹ iOS ç†Ÿæ‚‰çš„åŒå­¦åº”è¯¥éƒ½çŸ¥é“ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šåˆ›å»ºä¸€äº›æ‰©å±•æ¥å°è£…ä¸€äº›å¸¸ç”¨çš„ä»£ç å—ä»¥ä¾¿æˆ‘ä»¬å¿«é€Ÿå¼€å‘ï¼Œæˆ‘ä¹Ÿä¸ä¾‹å¤–ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­æˆ‘æœé›†äº†ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„ä»£ç ç‰‡æ®µæ”¾åœ¨github ä»“åº“é‡Œï¼Œè¿™é‡Œæˆ‘è¦è®²çš„æ˜¯å¯¹ UIView çš„ä¸€äº›æ‰©å±•ã€‚
â€ƒâ€ƒ<!-- more -->
## æ­£æ–‡
1. flatSubviews
â€ƒâ€ƒæƒ³å¿…å¤§å®¶æœ‰è¿‡è¿™æ ·çš„ç»å†å§ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç³»ç»Ÿæ§ä»¶è¿›è¡Œæ›´æ”¹ï¼Œå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯å¯¹ç¬¬ä¸‰æ–¹æ§ä»¶è¿›è¡Œä¿®æ”¹ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¾€å¾€éœ€è¦å»éå†ä¸€ä¸ªè§†å›¾çš„æ‰€æœ‰å­è§†å›¾ï¼Œå½“ç„¶è¿™ä¸ªæ—¶å€™å¤§å®¶å¯èƒ½é¦–å…ˆä¼šæƒ³åˆ°ä½¿ç”¨ç³»ç»Ÿçš„ subviews å±æ€§ï¼Œä½†æ˜¯ï¼Œè¿™åªèƒ½å¾—åˆ°å½“å‰è§†å›¾çš„æ‰€æœ‰å­è§†å›¾ï¼Œé‚£ä¹ˆå­è§†å›¾çš„å­è§†å›¾å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä¸º UIView æ‰©å±•äº†ä¸€ä¸ªå±æ€§  flatSubviews ï¼Œè¿™ä¸ªå±æ€§åŒ…å«äº†è§†å›¾çš„å­è§†å›¾ä»¥åŠå­è§†å›¾çš„å­è§†å›¾ï¼Œå…¶å®å®ç°æ–¹æ³•å¹¶ä¸éš¾ï¼Œè¿™é‡Œä¸»è¦ä½¿ç”¨åˆ°äº†è¿­ä»£æ¨¡å¼ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä¸­çš„å†…éƒ¨å®ç°ï¼š

```swift
/// `self`'s all subviews include the subview's subviews.
    var flatSubviews: [UIView] {
        var views: [UIView] = []
        self.subviews.forEach { (sub) in
            views.append(sub)
            if !sub.subviews.isEmpty {
                views += sub.flatSubviews
            }
        }
        return views
    }
```
çœ‹åˆ°è¿™é‡Œå¤§å®¶æ˜¯ä¸æ˜¯è§‰å¾—å…¶å®å¾ˆç®€å•å‘¢ï¼Ÿâ˜º

2. functions
(1) ä¾¿æ·çš„ä¸º View æ·»åŠ åœ†è§’

```swift
    ///  When positive, the background of the layer will be drawn with rounded corners. Also effects the mask generated by the`masksToBounds' property. Defaults to true. Animatable.
    func cornerRadius(_ radius: CGFloat) {
        layer.cornerRadius = radius
        layer.masksToBounds = true
    }
```
(2) å¿«é€Ÿæ·»åŠ ç‚¹å‡»æ‰‹åŠ¿

```swift 
    /// Add tapGesture/action for particular event.
    ///
    /// - Parameters:
    ///   - tapNumber: Default is 1. The number of taps required to match
    ///   - target: `self`
    ///   - action: a `Selector`
    func addTapGesture(_ tapNumber: Int = 1, target: Any = self, action: Selector) {
        let tap = UITapGestureRecognizer(target: target, action: action)
        tap.numberOfTapsRequired = tapNumber
        isUserInteractionEnabled = true
        addGestureRecognizer(tap)
    }
```

(3) æˆªå–è§†å›¾

```swift
/// Returns an image of the current view
    ///
    /// - Parameter scale: scale
    /// - Returns: A new image
    func getSnapshot(scale: CGFloat = 0) -> UIImage {
        UIGraphicsBeginImageContextWithOptions(bounds.size, false, scale)
        drawHierarchy(in: bounds, afterScreenUpdates: true)
        let image = UIGraphicsGetImageFromCurrentImageContext()!
        UIGraphicsEndImageContext()
        return image
    }
```
(4) æ·»åŠ è¾¹çº¿
â€ƒâ€ƒ ä¸º View æ·»åŠ è¾¹çº¿ä¹Ÿæ˜¯ä¸€ä¸ªé«˜é¢‘çš„éœ€æ±‚ï¼Œæˆ‘ä»¬ä¼šç»å¸¸é‡åˆ°ä¸º UITextField æˆ–è€… è‡ªå®šä¹‰çš„ Cell æ·»åŠ ä¸‹è¾¹çº¿ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šæƒ³åˆ°ä½¿ç”¨è´å¡å°”æ›²çº¿ï¼Œæˆ‘å¼€å§‹ä¹Ÿæ˜¯è¿™æ ·ç”¨çš„ï¼Œåæ¥å‘ç°åœ¨é€‚é…æ¨ªç«–å±çš„æ—¶å€™æ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœä½ æ¯”è¾ƒå¥½çš„å®ç°æ–¹å¼ï¼Œå¸Œæœ›ä½ èƒ½å‘Šè¯‰æˆ‘ã€‚åæ¥è¿˜æ˜¯å†³å®š ä½¿ç”¨ UIView è‡ªå®šä¹‰ Line ï¼Œç„¶åç”¨ AutoLayout æ·»åŠ çº¦æŸï¼Œè¿™æ ·å°±å®Œç¾çš„é€‚é…äº†æ¨ªç«–å±äº†ã€‚

```swift
    func addBorder(for edges: [UIRectEdge], width: CGFloat = 1, color: UIColor = .black, insets: UIEdgeInsets = UIEdgeInsets(all: 0)) {
        var edgesValues: [UIRectEdge] = edges
        if edges.contains(.all) {
            edgesValues = [.top, .bottom, .left, .right]
        }
        let allSpecificBorders:[UIRectEdge] = [.top, .bottom, .left, .right]
        for edge in allSpecificBorders {
            if let view = viewWithTag(Int(edge.rawValue)) {
                view.removeFromSuperview()
            }

            if edgesValues.contains(edge) {
                let view = UIView()
                view.tag = Int(edge.rawValue)
                view.backgroundColor = color
                view.translatesAutoresizingMaskIntoConstraints = false
                addSubview(view)
                var horizontalVisualFormat = "H:"
                var verticalVisualFormat = "V:"
                switch edge {
                case UIRectEdge.bottom:
                    horizontalVisualFormat += "|-(\(insets.left))-[v]-(\(insets.right))-|"
                    verticalVisualFormat += "[v(\(width))]-(\(insets.bottom))-|"
                case UIRectEdge.top:
                    horizontalVisualFormat += "|-(\(insets.left))-[v]-(\(insets.right))-|"
                    verticalVisualFormat += "|-(\(insets.top))-[v(\(width))]"
                case UIRectEdge.left:
                    horizontalVisualFormat += "|-(\(insets.left))-[v(\(width))]"
                    verticalVisualFormat += "|-(\(insets.top))-[v]-(\(insets.bottom))-|"
                case UIRectEdge.right:
                    horizontalVisualFormat += "[v(\(width))]-(\(insets.right))-|"
                    verticalVisualFormat += "|-(\(insets.left))-[v]-(\(insets.right))-|"
                default:
                    break
                }
                self.addConstraints(NSLayoutConstraint.constraints(withVisualFormat: horizontalVisualFormat, options: .directionLeadingToTrailing, metrics: nil, views: ["v": view]))
                self.addConstraints(NSLayoutConstraint.constraints(withVisualFormat: verticalVisualFormat, options: .directionLeadingToTrailing, metrics: nil, views: ["v": view]))
            }
        }
    }
```
ä½¿ç”¨æ•ˆæœï¼š
![simulator screen shot 2017 8 12 9 20 15](http://upload-images.jianshu.io/upload_images/121208-9afc52ee4f74c1e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

UI æ‰©å±•ï¼Œè¯·çœ‹    [UIKit.plus](https://github.com/CNKCQ/UIKit.plus)
æ°´å¹³æœ‰é™ï¼Œå¦‚æœ‰ç–æ¼ï¼Œæœ›æŒ‡æ­£
æ¬¢è¿äº¤æµï¼Œæ¬¢è¿ star  [CNKCQ](https://github.com/CNKCQ)
é—äººğŸŒ¹ï¼Œæ‰‹æœ‰ä½™é¦™      [blog](http://wangchenquan.com/)

